match p = (a:user)-[:retweets*0..10]->(f:user)-[m:mentions]->(t:topic) with p, a, t, m.count * (1.0/length(p)) as weightedCount return a.id, a.name, t.id, sum(weightedCount) order by sum(weightedCount) desc limit 30;
